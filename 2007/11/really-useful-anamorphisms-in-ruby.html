<html> 
<head>
        
        <title>Really useful anamorphisms in Ruby</title>

	<link rel="stylesheet" type="text/css" href="/blog.css" />
	<link rel="stylesheet" type="text/css" href="/sunburst.css" />



	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>

<body>

	<div id="leftcontent">
			<a href="http://weblog.raganwald.com/"><img src="/assets/media/raganwald_2008_350_150.png" 
			width="350" height="150" border="0" alt="raganwald" title="raganwald 2008" align="middle"/></a><br/>
			
				<div class="DateHeader">Friday, November 09, 2007</div>
			

			<div class="Post"><a name="2961100763442932381">&nbsp;</a>
				<span class="PostTitle">

					<a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html" title="permanent link">Really useful anamorphisms in Ruby</a></span>
					<div style="clear:both;"></div><a href="http://weblog.raganwald.com/2007/11/really-simple-anamorphisms-in-ruby.html" title="Really simple anamorphisms in Ruby">Really simple anamorphisms in Ruby</a> introduced a very simple <a href="http://raganwald.com/source/unfold.rb.html" title="unfold.rb">unfold</a>. Its chief characteristics were that it generated an Array from a value of some sort, and it did so by applying an incrementor block to its seed recursively until it generated nil. For example:<pre><code><br />10.class.unfold(&amp;:superclass)<br />    =&gt; [Fixnum, Integer, Numeric, Object]<br /></code></pre>A very simple modification allows us to separate the two blocks with a :while or :to pseudo-keyword, and to add a :map keyword for transforming the state into the desired result. Thus, this really simple unfold:<pre><code><br />1.unfold(<a href="http://weblog.raganwald.com/2007/10/stringtoproc.html" title="String#to_proc">&amp;'_+1 unless _==10'</a>).map(&amp;'**2')<br />    =&gt; [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]<br /></code></pre>Can also be expressed as:<pre><code><br />1.unfold(:to =&gt; '==10', :map =&gt; '**2', &amp;'_+1')<br />    =&gt; [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]<br /></code></pre>The latter form is helpful once unfolds become larger and more complex than these simple one-liners.<br /><br />(There is another style of writing :unfold, using method chaining and lazy evaluation to eliminate lambda keywords, but we will save that for another time: it is a great examination of syntax but does not change :unfold&rsquo;s fundamental behaviour.)<br /><br /><strong>Let&#8217;s turn it up a notch</strong><br /><br />These trivial examples are not particularly compelling. Unfold is touted as the complement to :inject. So you would expect :unfold to be as useful as :inject. And :inject is very, very useful&mdash;you &#8220;reduce&#8221; lists of things to values all the time.<br /><br />But how often do you need to turn a value into a list? How often do you need to turn &#8216;10&#8217; into &#8216;[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]&#8217;? And if you do, what&#8217;s wrong with using <code>(1..10).map(&amp;'**2')</code>?<br /><br />Remember that :unfold can be applied to objects with a lot more information to them. The thing that had me stuck when I first saw :unfold was thinking of it as the opposite of :inject. Or at least, the opposite of how I used :inject. I tended to use :inject in a way that reduced information. For example:<pre><code><br />[7, 6, 10, 3, 9, 4, 8, 5, 2, 1].inject(&amp;'+')<br /></code></pre>This gives us the sum of the numbers from one to ten, as it happens. It also gives us a value that is considerably simpler than the list we used to generate the number. Information is lost when we use :inject to &#8220;reduce&#8221; a list to a very simple value. So my first reaction to :unfold was to think of ways to use :unfold on very simple values, like numerics.<br /><br />But :unfold doesn&#8217;t have to work with simple values. It can work with arbitraily complex data structures. Consider:<pre><code><br />def zip(*lists)<br />  lists.unfold(<br />      :while =&gt; '.first', <br />      :map =&gt; '.map(&amp;".first")',<br />      &amp;'_.reject(&amp;".length &lt; 2").map(&amp;"[1..-1]")')<br />end<br /></code></pre>Zip is a function that takes two (or more, but let&#8217;s just say two for now) lists, and produces a list of pairs of items. So:<pre><code><br />zip([:a, :b, :c], [1, 2, 3])<br />    =&gt; [[:a, 1], [:b, 2], [:c, 3]]<br /></code></pre>How does :unfold do it? First, of course, it makes a single list of lists. It then performs an unfold on this single data structure. The incrementor successively reduces each sublist by removing the first items. So the output of the successive incrementor operations is:<pre><code><br />[<br />    [[:a, :b, :c], [1, 2, 3]],<br />    [[b, :c],      [2, 3]]<br />    [[:c],         [3]]<br />]<br /></code></pre>The :map then extracts the first items from each sublist and presents them as a list:<pre><code><br />[<br />    [:a,           1], <br />    [:b,           2], <br />    [:c,           3]<br />]<br /></code></pre>Neat. But why do we care about zip? Well, if you&#8217;ll notice, we already have a bunch of really useful things we can do with lists, like :map, :select, :reject, :detect, and so on. What would you do if you had two lists and needed to do something with each pair in the list, like&#8230; A list of first names and surnames that need to be catenated together?<pre><code><br />zip(first_names, surnames).map(&amp;'"#{_[0]} #{_[1]}"')<br /></code></pre>Zip is useful when we have a bunch of parallel lists and there&#8217;s something we want to do with each tuple from the lists.<br /><br /><strong>Generalized iteration</strong><br /><br />We recognize this &#8220;pattern,&#8221; it&#8217;s one of the most powerful in programming. Zip was one algorithm, a way of iterating over several lists simultaneously. The other algorithm was <code>"#{_[0]} #{_[1]}"</code>, a recipe for what to do with the successive tuples of values.<br /><br /><div class="book"><hr/><em><a name="evtst|a|0672328844" href="http://www.amazon.com/gp/product/0672328844?ie=UTF8&amp;tag=raganwald001-20&amp;link_code=as3&amp;camp=211189&amp;creative=373489&amp;creativeASIN=0672328844"><img src="http://weblog.raganwald.com/uploaded_images/the_ruby_way.jpg" border="0"></a><img src="http://www.assoc-amazon.com/e/ir?t=raganwald001-20&amp;l=as2&amp;o=1&amp;a=0672328844" alt="" style="border: medium none  ! important; margin: 0px ! important;" border="0" height="1" width="1"><br><br><a name="evtst|a|0672328844" href="http://www.amazon.com/gp/product/0672328844?ie=UTF8&amp;tag=raganwald001-20&amp;link_code=as3&amp;camp=211189&amp;creative=373489&amp;creativeASIN=0672328844">The Ruby Way</a><img src="http://www.assoc-amazon.com/e/ir?t=raganwald001-20&amp;l=as2&amp;o=1&amp;a=0672328844" alt="" style="border: medium none  ! important; margin: 0px ! important;" border="0" height="1" width="1"> is the perfect second Ruby book for serious programmers. The Ruby Way contains more than four hundred examples explaining how to do everything from distribute Ruby with Rinda to functional programming techniques just like these.</em><hr/></div>The powerful idea was to separate the mechanics of turning a data structure into a linear series of values&#8212;iterating&#8212;from what we want to actually do with each value. (In OO-style programming, we would define a method for lists of lists that returns an iterator over the tuples of values. Same thing, proving that how you do it is not as important as understanding <em>why</em> you do it.)<br /><br />Unfold has other uses, but this one alone is worth the trouble to understand the pattern even if you aren&rsquo;t rushing to implement this exact unfold method: Converting a single data structure to a list is one way to implement iteration: for any data structure, you can use unfold to define a linear iteration. You can then use :each or :map or :inject just as our parents before us would have used DO or FOR loops.<br /><br />Consider this (inelegant, but I&#8217;m writing this rather late at night) unfold:<pre><code><br />[[1, 2, 3], [4, 5, 6, [7, 8]], 9, 10].unfold(<br />  :while =&gt; '.first',<br />  :map =&gt; lambda { |first|<br />    first = first.first while first.kind_of?(Array)<br />    first<br />  }<br />) { |state|<br />  state = state.first + state[1..-1] while state.first.kind_of?(Array)<br />  state[1..-1]<br />}<br />    =&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]<br /></code></pre>This is the same idea, only we convert a tree into a list representing a depth-first search of a simple tree. You may recognize it as Array&#8217;s :flatten method. Once again, it&#8217;s really a way of iterating over the elements of a tree. So one way to think of this :unfold is that it is an iterator over a tree&#8217;s leaves:<pre><code><br />def flatten(arr)<br />  arr.unfold(<br />    :while =&gt; '.first',<br />    :map =&gt; lambda { |first|<br />      first = first.first while first.kind_of?(Array)<br />      first<br />    }<br />  ) { |state|<br />    state = state.first + state[1..-1] while state.first.kind_of?(Array)<br />    state[1..-1]<br />  }<br />end<br /></code></pre><strong>But I already know how to write Zip and Flatten methods, honest I do.</strong><br /><br />Zip and Flatten <em>are</em> relatively common, that&rsquo;s why :flatten and :zip can both be found in Ruby&rsquo;s standard Array class. And if there&rsquo;s a data structure that needs regular unfolding, you ought to weigh the advantages and disadvantages of writing an :unfold for it or using more humdrum ways of writing an iterator.<br /><br /><div class="book"><hr/><em>  <a name="evtst|a|0521644089" href="http://www.amazon.com/gp/product/0521644089?ie=UTF8&amp;tag=raganwald001-20&amp;link_code=as3&amp;amp;camp=211189&amp;creative=373489&amp;creativeASIN=0521644089"><img src="http://weblog.raganwald.com/uploaded_images/haskell_school_of_expression.jpg" border="0"></a><img src="http://www.assoc-amazon.com/e/ir?t=raganwald001-20&amp;l=as2&amp;amp;amp;o=1&amp;a=0521644089" alt="" style="border: medium none  ! important; margin: 0px ! important;" border="0" height="1" width="1"><br /><br /><a name="evtst|a|0521644089" href="http://www.amazon.com/gp/product/0521644089?ie=UTF8&amp;tag=raganwald001-20&amp;link_code=as3&amp;amp;camp=211189&amp;creative=373489&amp;creativeASIN=0521644089">The Haskell School of Expression</a><img src="http://www.assoc-amazon.com/e/ir?t=raganwald001-20&amp;l=as2&amp;amp;amp;o=1&amp;a=0521644089" alt="" style="border: medium none  ! important; margin: 0px ! important;" border="0" height="1" width="1"> is a terrific and relatively jargon-free introduction to the language that popularized fold, unfold, and all of the other functional programming idioms. As Eric Kidd says, it will make your head explode. Recommended!</em><hr/></div>However, what do you do when you only need to unfold something once? For example, perhaps you have code that obtains some data in JSON format, and having used a library to parse the JSON into a one-off list or hash, you want to iterate through it.<br /><br />With unfold, you can write your one-time, specific iterator right in place. This is no different than using blocks and lambdas in Ruby for one-off functions that really don&rsquo;t need the cermony and weight of being implemented as methods.<br /><br />When you want to iterate through something, and you want to separate the mechanism for iterating through the data from what you do with the data, :unfold should be in your tool box.<br /><br /><strong>Unfold and the bio-sciences. Not really.</strong><br /><br />I like to think of :unfold like unfolding a protein molecule. When you stare at a data structure, it&#8217;s dense, opaque. But you supply an unfold algorithm, and what looked like a messy ball of twine unravels into a long filament made up of simple elements. You can then operate on the simple elements, without getting what you want to do en-snarled in how you iterate over the data structure.<br /><br />So there you have it. Unfold can be really useful if we see it as a standardized way to write iterators for data structures.<br /><br /><hr/><em>Update: <a href="http://citeseer.ist.psu.edu/283921.html">The under-appreciated unfold</a>.</em><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://weblog.raganwald.com/labels/lispy.html">lispy</a>, <a rel='tag' href="http://weblog.raganwald.com/labels/popular.html">popular</a>, <a rel='tag' href="http://weblog.raganwald.com/labels/ruby.html">ruby</a></p>&nbsp;
					<span class="PostFooter">

						&para; <a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html" title="permanent link">10:46 PM</a>

					 
				</span> 


                                        <p id="postfeeds"></p>

			</div>

			
			    <div class="blogComments">
                                
                                <a name="comments"></a><strong>Comments on &ldquo;<em>Really useful anamorphisms in Ruby</em>&rdquo;</strong>:<br/>
						
							<div class="blogComment">
								<a name="718978523115820642"></a> 				hmm and is this needed?<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1194723300000#c718978523115820642" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="http://www.blogger.com/img/anon16-rounded.gif" alt="Anonymous" style="display:inline;" /></span>&nbsp;<span class="anon-comment-author">Anonymous</span> : 2:35 PM</div>

								<span class="item-control blog-admin pid-464447867"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=718978523115820642" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="3957387871533923643"></a> 				<I>is this needed</I><BR/><BR/>What do you mean by needed? My understanding is that:<BR/><BR/>1. All Turing-equivalent languages are equally powerful.<BR/>2. Some of the world's largest and most profitable web applications are written in PHP.<BR/>3. And one of the others is written in .NET.<BR/>4. Some of the world's largest and most powerful business applications are still written in COBOL.<BR/>5. And most of the others are written in PL/SQL.<BR/>6. And Java.<BR/><BR/>So... You ask whether this is needed. And I ask, by whom? And for what?<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1194723540000#c3957387871533923643" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="http://www.blogger.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="http://www.blogger.com/profile/13132345822387028437" rel="nofollow">Reginald Braithwaite</a> : 2:39 PM</div>

								<span class="item-control blog-admin pid-697692447"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=3957387871533923643" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="5087437410339963224"></a> 				reginald: regarding 'inject' and 'unfold' being opposites, in fact I think there is a way to formalize this in terms of category theory. In a certain sense, these operations are 'dual' to each other.<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1194736860000#c5087437410339963224" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="http://www.blogger.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="http://www.blogger.com/profile/02768382790667979877" rel="nofollow">Slava Pestov</a> : 6:21 PM</div>

								<span class="item-control blog-admin pid-1143103893"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=5087437410339963224" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="6509068329815508134"></a> 				At what point does the ugliness and inefficiency become the wrong answer and a different language the right one?<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1194763200000#c6509068329815508134" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="http://www.blogger.com/img/anon16-rounded.gif" alt="Anonymous" style="display:inline;" /></span>&nbsp;<span class="anon-comment-author">Anonymous</span> : 1:40 AM</div>

								<span class="item-control blog-admin pid-1461190388"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=6509068329815508134" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="8593268910107561964"></a> 				<I>At what point does the ugliness and inefficiency become the wrong answer and a different language the right one?</I><BR/><BR/>First, of course, you can make that argument in favour of moving from Ruby to something that supports unfolds and other operations elegantly and efficiently.<BR/><BR/>And you can also make that argument in favour of moving from something else that supports unfold--like Hakell--back to Ruby or even Java and eschewing all attempts to build higher-order functionality out of duct tape and baling wire (Greenspunning).<BR/><BR/>I honestly can't answer the question. People have been going at that since the days when people argued Lisp vs. C, Smalltalk vs. C, Java vs. C++, almost everything vs. Java...<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1194786120000#c8593268910107561964" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="http://www.blogger.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="http://www.blogger.com/profile/13132345822387028437" rel="nofollow">Reginald Braithwaite</a> : 8:02 AM</div>

								<span class="item-control blog-admin pid-697692447"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=8593268910107561964" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="8192453652263638628"></a> 				Slava:<BR/><BR/>Yes, I knew they were foldr and foldl's dual. From "Really simple anamophisms in Ruby":<BR/><BR/><I>Anamorphisms are functions that map from some object to a more complex structure containing the type of the object. They are the dual—a fancy word for complement—of Catamorphisms, functions that map from some complex structure down to a simpler object.</I><BR/><BR/>But I leave the category theory to people who actually know what they are doing.<BR/><BR/>People mistakingly think this is a blog about programming. It's actually a job about passion, about being excited and deeply motivated by programming. So... if someone says, "Cool!!!" And is deeply engaged, engaged enough to go elsewhere and read more and play with unfold, maybe find a new way to think about how to do things...<BR/><BR/>That works for me.<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1194786660000#c8192453652263638628" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="http://www.blogger.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="http://www.blogger.com/profile/13132345822387028437" rel="nofollow">Reginald Braithwaite</a> : 8:11 AM</div>

								<span class="item-control blog-admin pid-697692447"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=8192453652263638628" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="5106035221364834745"></a> 				Which version of Ruby are you using? <BR/>I have 1.86 but get a type error (expected proc).<BR/>Seems this might be the shove I needed to upgrade to 1.9<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1194826440000#c5106035221364834745" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="http://www.blogger.com/img/anon16-rounded.gif" alt="Anonymous" style="display:inline;" /></span>&nbsp;<span class="anon-comment-author">Anonymous</span> : 7:14 PM</div>

								<span class="item-control blog-admin pid-1753455467"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=5106035221364834745" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="4006806715007602250"></a> 				With these examples, you need <A HREF="http://raganwald.com/source/string_to_proc.rb.html" REL="nofollow">String#to_proc</A> to handle all the &'==10' expressions.<BR/><BR/>If you find these "butt ugly," you can substitute lambdas. So instead of &'==10', use lambda { |n| n==10 }. Same thing.<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1194828840000#c4006806715007602250" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="http://www.blogger.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="http://www.blogger.com/profile/13132345822387028437" rel="nofollow">Reginald Braithwaite</a> : 7:54 PM</div>

								<span class="item-control blog-admin pid-697692447"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=4006806715007602250" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="6584710421848163998"></a> 				All that tasty String#to_proc sugar is starting to make me salivate.<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1194880020000#c6584710421848163998" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="http://www.blogger.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="http://www.blogger.com/profile/09978112515173586772" rel="nofollow">Sofal</a> : 10:07 AM</div>

								<span class="item-control blog-admin pid-278936696"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=6584710421848163998" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="1316735338901533906"></a> 				I find unfold is particularly useful for expressing numerical solutions for differential equations.  In Common Lisp I have an implementation of unfold that lets me write things like the example given in the docstring at <A HREF="http://paste.lisp.org/display/52918" REL="nofollow">http://paste.lisp.org/display/52918</A><br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1198327080000#c1316735338901533906" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="http://www.blogger.com/img/anon16-rounded.gif" alt="Anonymous" style="display:inline;" /></span>&nbsp;<a href="http://blog.superadditive.com" rel="nofollow">jmbr</a> : 7:38 AM</div>

								<span class="item-control blog-admin pid-352182423"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=1316735338901533906" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="3756760485065385373"></a> 				In relation to your molecule analogy (end of post), the term "denaturing" is what comes to mind.<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1199491980000#c3756760485065385373" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon openid-comment-icon"><img src="http://www.blogger.com/img/openid16-rounded.gif" alt="OpenID" style="display:inline;" /></span>&nbsp;<a href="http://david.peterson.id.au/" rel="nofollow">david</a> : 7:13 PM</div>

								<span class="item-control blog-admin pid-476711463"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=3756760485065385373" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="8668525093801036537"></a> 				I think you only defined one anamorphism. You could also define them on arbitrary inductive datatypes. There was a toy language called Charity that was based on category theory and its basic control structures were catamorphisms and anamorphisms (general recursion was banned). You can then zip binary trees easily, for instance.<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1209003780000#c8668525093801036537" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="http://www.blogger.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="http://www.blogger.com/profile/10746976399050925428" rel="nofollow">Robert</a> : 10:23 PM</div>

								<span class="item-control blog-admin pid-119458486"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=8668525093801036537" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="4301426874692907208"></a> 				Robert:<BR/><BR/>a. You&rsquo;re right, I only defined one type of anamorphism, and...<BR/><BR/>b. Anamorphisms on inductive data types would be really useful.<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1209038220000#c4301426874692907208" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="http://www.blogger.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="http://www.blogger.com/profile/13132345822387028437" rel="nofollow">Reginald Braithwaite</a> : 7:57 AM</div>

								<span class="item-control blog-admin pid-697692447"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=4301426874692907208" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
							<div class="blogComment">
								<a name="2705443863350242506"></a> 				Hi, awesome post.  You mention that inject &quot;loses information.&quot;  While this is can be true in the 1 argument use, inject can also behave like &quot;fold left&quot; and take an accumulator of any data type, along with a function that takes the &quot;built value&quot; so far, and the current item in the original array.  Here&#39;s an example using your first problem, getting the squares of the numbers 1 to 10 in an array, where in |xs,y| xs is the &#39;start&#39; value and y is the original array value:<br /><br />(1..10).inject([]){|xs,y| [y*y]+xs }.reverse #prepending, o(1) if ruby&#39;s array is a singly linked list?<br /><br />(1..10).inject([]){|xs,y| xs+[y*y]} #appending, shorter, maybe slower<br /><br />You can&#39;t deny the power of unfolding, but I&#39;ve found that inject by itself is pretty powerful when used in this form.  Thanks for the great writeup and code snippets.<br />
								<div class="byline"><a href="http://weblog.raganwald.com/2007/11/really-useful-anamorphisms-in-ruby.html?showComment=1250200492339#c2705443863350242506" title="permanent link">#</a> posted by <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="http://www.blogger.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="http://www.blogger.com/profile/07481564809396207815" rel="nofollow">Alan</a> : 5:54 PM</div>

								<span class="item-control blog-admin pid-1821331343"><a style="border:none;" href="http://www.blogger.com/delete-comment.g?blogID=7618424&postID=2705443863350242506" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
							</div>
						
						
					  
					<br /> <p id="postfeeds"></p> <br />
					

					<br /> <br />
					<a href="http://weblog.raganwald.com/welcome.html">&lt;&lt; Home</a>
				</div>

			

		


	</div>







	<div id="rightcontent">

		<div class="SideBarTitle"><a href="http://braythwayt.com">Reg Braithwaite</a></div>

		<br />

		<br />

		<div class="SideBarTitle">Recent Writing</div>

                <a href="http://homoiconic.com">Homoiconic Technical Writing</a> / <a href ="http://raganwald.posterous.com">raganwald.posterous.com</a><br>
			<br>
			<div class="SideBarTitle">
				Books
			</div><a href="http://leanpub.com/shippingsoftware" title="A quarter-century of experience shipping software, distilled into fixnum bittersweet essays">What I&lsquo;ve Learned From Failure</a> / <a href="http://leanpub.com/combinators" title="Raganwald's collected adventures in Combinatory Logic and Ruby Meta-Programming">Kestrels, Quirky Birds, and Hopeless Egocentricity</a>

		<br/>

		<br/>

		<div class="SideBarTitle">Share</div>

                <a href="http://github.com/raganwald/rewrite_rails">rewrite_rails</a> /

                <a href="http://github.com/raganwald/andand">andand</a> /

                <a href="http://raganwald.com/source/unfold.rb.html">unfold.rb</a> /

                <a href="http://raganwald.com/source/string_to_proc.rb.html">string_to_proc.rb</a> /

                <a href="http://raganwald.com/source/dsl_and_let.html">dsl_and_let.rb</a> /

                <a href="http://raganwald.com/source/comprehensions.html">comprehension.rb</a> /

                <a href="http://raganwald.com/source/lazy_lists.html">lazy_lists.rb</a>

		<br />

		<br />

		<div class="SideBarTitle">Beauty</div> <!-- idioms -->

		<a href="http://weblog.raganwald.com/2008/04/is-strictly-equivalent-to.html">IS-STRICTLY-EQUIVALENT-TO-A</a> /

		<a href="http://weblog.raganwald.com/2008/03/spaghetti-western-coding.html">Spaghetti-Western Coding</a> /

		<a href="http://weblog.raganwald.com/2007/12/golf-is-good-program-spoiled.html">Golf is a good program spoiled</a> /

		<a href="http://weblog.raganwald.com/2007/11/programming-conventions-as-signals.html">Programming conventions as signals</a> /

                <a href="http://weblog.raganwald.com/2007/10/too-much-of-good-thing-not-all.html">Not all functions should be object methods</a>

<br/><br/>

                <a href="http://weblog.raganwald.com/2007/05/not-so-big-software-application.html">The Not So Big Software Design</a> /

		<a href="http://weblog.raganwald.com/2007/04/writing-programs-for-people-to-read.html">Writing programs for people to read</a> /
                
		<a href="http://weblog.raganwald.com/2007/03/why-why-functional-programming-matters.html">Why Why Functional Programming Matters Matters</a> /

		<a href="http://weblog.raganwald.com/2007/02/but-y-would-i-want-to-do-thing-like.html">But Y would I want to do a thing like this?</a>

		<br />

		<br />

		<div class="SideBarTitle">Work</div>

                <a href="http://weblog.raganwald.com/2008/04/single-most-important-thing-you-must-do.html">The single most important thing you must do to improve your programming career</a> /

                <a href="http://weblog.raganwald.com/2008/02/naive-approach-to-hiring-people.html">The Na&iuml;ve Approach to Hiring People</a> /

                <a href="http://weblog.raganwald.com/2008/01/no-disrespect.html">No Disrespect</a> /

		<a href="http://weblog.raganwald.com/2006/11/take-control-of-your-interview.html">Take control of your interview</a> /

		<a href="http://weblog.raganwald.com/2006/08/three-tips-for-getting-job-through.html">Three tips for getting a job through a recruiter</a> /

		<a href="http://weblog.raganwald.com/2006/06/my-favourite-interview-question.html">My favourite interview question</a>

                <br/>

                <br/>



		<div class="SideBarTitle">Management</div>

		<a href="http://weblog.raganwald.com/2008/02/exception-handling-in-software.html">Exception Handling in Software Development</a> /

		<a href="http://weblog.raganwald.com/2007/11/what-if-powerful-languages-and-idioms.html">What if powerful languages and idioms only work for small teams?</a> /

                <a href="http://weblog.raganwald.com/2007/08/bricks.html">Bricks</a> /

                <a href="http://weblog.raganwald.com/2007/06/which-theory-first-evidence.html">Which theory fits the evidence?</a> /

                <a href="http://weblog.raganwald.com/2007/06/still-failing-still-learning.html">Still failing, still learning</a> /

		<a href="http://weblog.raganwald.com/2005/01/what-ive-learned-from-failure.html">What I&rsquo;ve learned from failure</a>

		<br />

		<br />

		<div class="SideBarTitle">Notation</div> <!-- languages -->

		<a href="http://weblog.raganwald.com/2008/06/what-does-do-when-used-as-unary.html">The unary ampersand in Ruby</a> /

		<a href="http://weblog.raganwald.com/2008/02/1100inject.html">(1..100).inject(&amp;:+)</a> /

                <a href="http://weblog.raganwald.com/2007/10/challenge-of-teaching-yourself.html">The challenge of teaching yourself a programming language</a> /

                <a href="http://weblog.raganwald.com/2006/11/significance-of-meta-circular_22.html">The significance of the meta-circular interpreter</a> /
                
                <a href="http://weblog.raganwald.com/2007/08/block-structured-javascript.html">Block-Structured Javascript</a> /

                <a href="http://weblog.raganwald.com/2007/02/haskell-ruby-and-infinity.html">Haskell, Ruby and Infinity</a> /

		<a href="http://weblog.raganwald.com/2007/01/closures-and-higher-order-functions.html">Closures and Higher-Order Functions</a>

		<br />

		<br />

		<div class="SideBarTitle">Opinion</div>

		<a href="http://weblog.raganwald.com/2008/05/why-apple-is-more-expensive-than-amazon.html">Why Apple is more expensive than Amazon</a> /

		<a href="http://weblog.raganwald.com/2008/04/why-we-are-biggest-obstacle-to-our-own.html">Why we are the biggest obstacles to our own growth</a> /

		<a href="http://weblog.raganwald.com/2008/03/process-is-to-software-as-software-is.html">Is software the documentation of business process mistakes?</a> /

		<a href="http://weblog.raganwald.com/2007/09/we-have-lost-control-of-apparatus.html">We have lost control of the apparatus</a> /

		<a href="http://weblog.raganwald.com/2007/01/what-ive-learned-from-sales-part-i.html">What I&rsquo;ve Learned From Sales</a>
                <a href="http://weblog.raganwald.com/2007/01/what-ive-learned-from-sales-part-i.html" title="What I've Learned From Sales, Part I: Don't Feed the Trolls">I</a>, 
                <a href="http://weblog.raganwald.com/2007/01/what-ive-learned-from-sales-part-ii.html" title="What I've Learned from Sales, Part II: Wanna Bet?">II</a>, 
                <a href="http://weblog.raganwald.com/2007/10/how-to-use-blunt-instrument-to-sharpen.html" title="What I've Learned from Sales, Part III: How to use a blunt instrument to sharpen your saw">III</a>

		<br/>

		<br/>

		<div class="SideBarTitle">Whimsey</div>

                <a href="http://weblog.raganwald.com/2008/05/narcissism-of-small-code-differences.html">The Narcissism of Small Code Differences</a> /

		<a href="http://weblog.raganwald.com/2008/01/billy-martins-technique-for-managing.html">Billy Martin&rsquo;s Technique for Managing his Manager</a> /

		<a href="http://weblog.raganwald.com/2007/10/three-stories-about-tao.html">Three stories about The Tao</a> /

		<a href="http://weblog.raganwald.com/2007/02/programming-language-stories.html">Programming Language Stories</a> /

		<a href="http://weblog.raganwald.com/2005/07/why-you-need-degree-to-work-for-bigco.html">Why You Need a Degree to Work For BigCo</a>

		<br />

		<br />

		<div class="SideBarTitle">History</div>

		
			<a href="http://weblog.raganwald.com/archives/2004_06_01_archive.html">06/04</a> /
		
			<a href="http://weblog.raganwald.com/archives/2004_07_01_archive.html">07/04</a> /
		
			<a href="http://weblog.raganwald.com/archives/2004_08_01_archive.html">08/04</a> /
		
			<a href="http://weblog.raganwald.com/archives/2004_09_01_archive.html">09/04</a> /
		
			<a href="http://weblog.raganwald.com/archives/2004_10_01_archive.html">10/04</a> /
		
			<a href="http://weblog.raganwald.com/archives/2004_11_01_archive.html">11/04</a> /
		
			<a href="http://weblog.raganwald.com/archives/2004_12_01_archive.html">12/04</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_01_01_archive.html">01/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_02_01_archive.html">02/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_03_01_archive.html">03/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_04_01_archive.html">04/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_06_01_archive.html">06/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_07_01_archive.html">07/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_08_01_archive.html">08/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_09_01_archive.html">09/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_10_01_archive.html">10/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2005_11_01_archive.html">11/05</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_01_01_archive.html">01/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_02_01_archive.html">02/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_03_01_archive.html">03/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_04_01_archive.html">04/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_05_01_archive.html">05/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_06_01_archive.html">06/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_07_01_archive.html">07/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_08_01_archive.html">08/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_09_01_archive.html">09/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_10_01_archive.html">10/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_11_01_archive.html">11/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2006_12_01_archive.html">12/06</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_01_01_archive.html">01/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_02_01_archive.html">02/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_03_01_archive.html">03/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_04_01_archive.html">04/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_05_01_archive.html">05/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_06_01_archive.html">06/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_07_01_archive.html">07/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_08_01_archive.html">08/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_09_01_archive.html">09/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_10_01_archive.html">10/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_11_01_archive.html">11/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2007_12_01_archive.html">12/07</a> /
		
			<a href="http://weblog.raganwald.com/archives/2008_01_01_archive.html">01/08</a> /
		
			<a href="http://weblog.raganwald.com/archives/2008_02_01_archive.html">02/08</a> /
		
			<a href="http://weblog.raganwald.com/archives/2008_03_01_archive.html">03/08</a> /
		
			<a href="http://weblog.raganwald.com/archives/2008_04_01_archive.html">04/08</a> /
		
			<a href="http://weblog.raganwald.com/archives/2008_05_01_archive.html">05/08</a> /
		
			<a href="http://weblog.raganwald.com/archives/2008_06_01_archive.html">06/08</a> /
		
			<a href="http://weblog.raganwald.com/archives/2008_07_01_archive.html">07/08</a> /
		
		
		<br/></p>
		<br/>

		

	</div>





	<div style="visibility: hidden">
		
		
		<script type="text/javascript" src="http://www.assoc-amazon.com/s/link-enhancer?tag=raganwald001-20">
		</script>
		<noscript>
			<img src="http://www.assoc-amazon.com/s/noscript?tag=raganwald001-20" alt="" />
		</noscript>
	</div>

</body>
</html>